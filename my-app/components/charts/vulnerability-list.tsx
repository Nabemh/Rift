"use client"

import { AlertTriangle } from "lucide-react"

interface Vulnerability {
  cve_id: string
  count: number
  severity?: string
}

interface VulnerabilityListProps {
  data: Vulnerability[]
  height?: number
}

export function VulnerabilityList({ data, height = 300 }: VulnerabilityListProps) {
  const getSeverityColor = (severity?: string) => {
    switch (severity?.toLowerCase()) {
      case "critical":
        return "text-red-600"
      case "high":
        return "text-orange-600"
      case "medium":
        return "text-yellow-600"
      case "low":
        return "text-green-600"
      default:
        return "text-gray-600"
    }
  }

  return (
    <div className="space-y-3 overflow-y-auto" style={{ height }}>
      {data.map((item, index) => (
        <div key={index} className="flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0">
          <div className="flex items-center gap-3">
            <AlertTriangle className={`w-4 h-4 ${getSeverityColor(item.severity)}`} />
            <div>
              <span className="text-sm font-medium text-gray-900">{item.cve_id}</span>
              {item.severity && (
                <span className={`ml-2 text-xs px-2 py-1 rounded-full bg-gray-100 ${getSeverityColor(item.severity)}`}>
                  {item.severity}
                </span>
              )}
            </div>
          </div>
          <span className="text-sm font-bold text-blue-600">{item.count}</span>
        </div>
      ))}
    </div>
  )
}
